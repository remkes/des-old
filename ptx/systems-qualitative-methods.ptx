<section xml:id="systems-qualitative-methods">
  <title>Qualitative Methods</title>
  <p>
    For first order autonomous equations,
    we used a phase-line analysis to determine the steady states and the trajectories of movement between the steady states.
    We analyzed the stability of the steady states,
    and the phase line gave a fairly complete picture of the behaviour of the system depending on an initial value.
    For systems of DEs, the same analysis applies;
    however, for each function involved in the system,
    we get an additional dimension of analysis.
    In this section, for ease of drawing the analysis,
    we restrict to systems with two functions and two equations.
  </p>
  <p>
    Let's write <m>p(t)</m> and <m>q(t)</m> for the two functions.
    As with phase-line analysis, we need autonomous equations.
    An autonomous system does not involve the independent variable explicitly,
    so it can be written in the form
    <md>
      <mrow>\frac{dp}{dt} \amp  = f(p,q)</mrow>
      <mrow>\frac{dq}{dt} \amp  = g(p,q)</mrow>
    </md>.
  </p>
  <p>
    The qualititative analysis takes place in the plane,
    which we call the phase-plane.
    The axes are the values of the functions <m>p</m> and <m>q</m>,
    so that an isolated point represents a starting value for <m>p</m> and <m>q</m>.
    We would like to identify the steady states,
    look at the trajectories, and analyze the stability of the steady states.
    We lay out the process.
    <ul>
      <li>
        <p>
          Draw the locus <m>f = 0</m>
          (this is called the <em>nullcline</em> of f).
          Do likewise for <m>g</m>
          (the nullcline of <m>g</m>).
          Label where <m>f>0</m> and <m>f\lt 0</m> on either side of the nullcines,
          and likewise for <m>g</m>.
        </p>
      </li>
      <li>
        <p>
          The steady states exists at the intersections of the nullclines,
          where for <m>f</m> and <m>g</m> are zero.
        </p>
      </li>
      <li>
        <p>
          Regions where <m>f>0</m> and <m>g>0</m> have growth in both variables.
          Label these with an arrow pointing up and right.
          Do likewise for the other three cases:
          <m>f>0</m> and <m>g\lt 0</m> has an arrow pointing up and left;
          <m>f\lt 0</m> and <m>g>0</m> has an arrow pointing down and right;
          and <m>f\lt 0</m> and <m>g\lt 0</m> has an arrow pointing down and left.
        </p>
      </li>
      <li>
        <p>
          On the nullclines of <m>f</m> away from the steady states,
          use the value of <m>g</m> to determine the movement along the nullclines and label that with an arrow.
          Do the same for the nullclines of <m>g</m>.
        </p>
      </li>
      <li>
        <p>
          The solution trajectories are paths in the plane which roughly follow the arrows.
        </p>
      </li>
    </ul>
  </p>
  <p>
    We want to know the stability of the steady states in the model.
    Recall for phase-linea analysis that the stability of the steady states was a relatively simple situation.
    There were only three cases:
    stable, unstable, and stable only from one side.
    For the phase-plane,
    there are many different behaviours for steady states.
    However, there are six frequent behaviours of steady states which we classify in the following list.
    <ul>
      <li>
        <p>
          The steady state can be entirely attractive,
          where all the nearby trajectories tend towards the steady state.
          If the trajectories tend towards the steady state with relatively little rotation,
          this is called a stable focus.
        </p>
      </li>
      <li>
        <p>
          The steady state can be entirevly repulsive,
          where all the nearby trajectories tend away from the steady state.
          If the trajetories tend directly away from the steady state with relatively little rotation,
          this is called an unstable focus.
        </p>
      </li>
      <li>
        <p>
          The steady state can be partially stable,
          where there is an axis which is attractive and an axis which is respulsive.
          This is called a saddle point.
        </p>
      </li>
      <li>
        <p>
          If the steady state is entirely attractive but the trajectories spiral inwards,
          then the steady state is a stable node.
        </p>
      </li>
      <li>
        <p>
          Similarly, if the steady state is entirely repulsive and the trajectories spiral outwards,
          then the state state is an unstable node.
        </p>
      </li>
      <li>
        <p>
          Finally, the steady state can be neither attracitve of repuslive and the nearby trajectories simply form periodic loops around the steady state.
          This is called a centre.
        </p>
      </li>
    </ul>
  </p>
  <p>
    <xref ref="figure-stable-focus-nullclines">Figure</xref>
    to <xref ref="figure-centre-trajectories"></xref> show the six cases.
    In each figure,
    vertical and horizontal lines are the nullclines and the intersection is the steady state.
    The directions of movement are shown on the left and the trajectories are shown on the right.
  </p>
  <p>
    These six cases, while the most common and the most important,
    are not the only possible behaviours.
    Many other strange behaviours and stability situations are possible.
    However, we will restrict our attention to systems that display one of these six behaviours.
  </p>
  <figure xml:id="figure-stable-focus-nullclines">
    <caption>Stable Focus - Nullclines and Directions</caption>
    <image width="400%" source="images/figure30.png" />
  </figure>
  <figure xml:id="figure-stable-focus-trajectories">
    <caption>Stable Focus - Trajectories</caption>
    <image width="400%" source="images/figure46.png" />
  </figure>
  <figure xml:id="figure-unstable-focus-nullclines">
    <caption>Unstable Focus - Nullclines and Directions</caption>
    <image width="400%" source="images/figure31.png" />
  </figure>
  <figure xml:id="figure-unstable-focus-trajectories">
    <caption>Unstable Focus - Trajectories</caption>
    <image width="400%" source="images/figure51.png" />
  </figure>
  <figure xml:id="figure-saddle-point-nullclines">
    <caption>Saddle Point - Nullclines and Directions</caption>
    <image width="400%" source="images/figure34.png" />
  </figure>
  <figure xml:id="figure-saddle-point-trajectories">
    <caption>Saddle Point - Trajectories</caption>
    <image width="400%" source="images/figure49.png" />
  </figure>
  <figure xml:id="figure-stable-node-nullclines">
    <caption>Stable Node - Nullclines and Directions</caption>
    <image width="400%" source="images/figure32.png" />
  </figure>
  <figure xml:id="figure-stable-node-trajectories">
    <caption>Stable Node - Trajectories</caption>
    <image width="400%" source="images/figure47.png" />
  </figure>
  <figure xml:id="figure-unstable-node-nullclines">
    <caption>Unstable Node - Nullclines and Directions</caption>
    <image width="400%" source="images/figure33.png" />
  </figure>
  <figure xml:id="figure-unstable-node-trajectories">
    <caption>Unstable Node - Trajectories</caption>
    <image width="400%" source="images/figure48.png" />
  </figure>
  <figure xml:id="figure-centre-nullclines">
    <caption>Centre - Nullclines and Directions</caption>
    <image width="400%" source="images/figure29.png" />
  </figure>
  <figure xml:id="figure-centre-trajectories">
    <caption>Centre - Trajectories</caption>
    <image width="400%" source="images/figure50.png" />
  </figure>
  <example>
    <statement>
      <p>
        Let's start with Lokta-Volterra.
        In the above notation, Lokta-Volterra is described by two DEs, with these functions.
        <md>
          <mrow>f(p,q) \amp  = ap - bpq</mrow>
          <mrow>g(p,q) \amp  = cpq - dq</mrow>
        </md>
      </p>
      <p>
        We need to graph the zero-loci of the right sides.
        <md>
          <mrow>ap - bpq \amp  = 0 \implies p ( a - bq) = 0</mrow>
          <mrow>cpq - dq \amp  = 0 \implies q (cp - d) = 0</mrow>
        </md>
      </p>
      <p>
        The loci we get are the two axes <m>p=0</m> and <m>q=0</m>,
        the horizontal line <m>q = \frac{a}{b}</m> and the vertical line <m>p = \frac{d}{c}</m>.
        There are four intersections points, <m>(0,0)</m>,
        <m>\left(\frac{d}{c},0\right)</m>,
        <m>\left(0,\frac{a}{b} \right)</m> and <m>\left( \frac{d}{c}, \frac{a}{b} \right)</m>.
        The later is the only steady state with non-zero values,
        so the only possibility for a steady state which actually involves both species.
        The nullcines are shown in <xref ref="figure-nullclines-lokta-voltera">Figure</xref>
        and the directions in <xref ref="figure-directions-lokta-voltera">Figure</xref>.
      </p>
      <p>
        The signs of <m>f(p,q)</m> and <m>g(p,q)</m> give the trajectory directions in each portion of the phase plane and on the nullclines.
        We can use those directions to sketch an idea of the trajectories of the system.
        For Lokta-Volterra,
        these directions show something which is vaguely circular or elliptical,
        as in <xref ref="figure-trajectories-lokta-voltera">Figure</xref>.
      </p>
    </statement>
  </example>
  <figure xml:id="figure-nullclines-lokta-voltera">
    <caption>The Nullclines for Lokta-Voltera</caption>
    <image width="800%" source="images/figure24.png" />
  </figure>
  <figure xml:id="figure-directions-lokta-voltera">
    <caption>The Directions for Lokta-Voltera</caption>
    <image width="800%" source="images/figure25.png" />
  </figure>
  <figure xml:id="figure-trajectories-lokta-voltera">
    <caption>The Trajectories for Lokta-Voltera</caption>
    <image width="800%" source="images/figure26.png" />
  </figure>
  <figure xml:id="figure-competition-example">
    <caption>The Nullclines and Directions for a Competition
    Example</caption>
    <image width="800%" source="images/figure27.png" />
  </figure>
  <example>
    <statement>
      <p>
        This is a competition example.
        <md>
          <mrow>\frac{dp}{dt} \amp  = \frac{1}{10} p\left(1- \frac{p + \frac{1}{10}q}{100} \right)</mrow>
          <mrow>\frac{dq}{dt} \amp  = \frac{1}{5} \left(1- \frac{q + \frac{1}{5} p}{200} \right)</mrow>
        </md>
      </p>
      <p>
        The zero loci of the right sides determine the nullclines.
        <md>
          <mrow>\frac{1}{10} p\left(1- \frac{p + \frac{1}{10}q}{100} \right) \amp  = 0</mrow>
          <mrow>\frac{1}{5} \left(1- \frac{q + \frac{1}{5} p}{200} \right) \amp  = 0</mrow>
        </md>
      </p>
      <p>
        Again, the axes <m>p=0</m> and <m>q=0</m> are nullclines.
        In addition, we have the lines
        <m>p = \frac{-q}{10} + 100</m> an <m>p - \frac{-5q} + 1000</m>.
        <xref ref="figure-competition-example">Figure</xref>
        shows the graph of the nullclines with the directions of movement added.
      </p>
      <p>
        The steady state is a stable focus.
        The trajectories are all inwards towards the steady state.
        Therefore, we can conclude that there is a stable equilibrium between the two competing species and that they populations will approach this equilibrium over time.
      </p>
    </statement>
  </example>
</section>